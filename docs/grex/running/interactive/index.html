<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Interactive work"><meta property="og:title" content="Interactive work"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="http://um-grex.github.io/grex-docs/docs/grex/running/interactive/"><title>Interactive work | Unofficial Grex User Guide</title><link rel=icon href=/grex-docs/favicon.png type=image/x-icon><link rel=stylesheet href=/grex-docs/book.min.06cbd313f49ddc884804421299d5dc11b1cd097fdcfed7f054a79a137890a2d7.css integrity="sha256-BsvTE/Sd3IhIBEISmdXcEbHNCX/c/tfwVKeaE3iQotc="><script defer src=/grex-docs/en.search.min.670565d93b9c7def1c30c1b196e9ef05642f0c1aa1376c3618a62dab01d24adc.js integrity="sha256-ZwVl2Tucfe8cMMGxlunvBWQvDBqhN2w2GKYtqwHSStw="></script><link rel=alternate type=application/rss+xml href=http://um-grex.github.io/grex-docs/docs/grex/running/interactive/index.xml title="Unofficial Grex User Guide"></head><body><input type=checkbox class=hidden id=menu-control><main class="flex container"><aside class="book-menu fixed"><nav><style>hr{border:0;height:3px;background-image:linear-gradient(to right,transparent,#095484,transparent)}</style><h2 class=book-brand><a href=http://um-grex.github.io/grex-docs><img src=/grex-docs/logo/um_logo_email_signature.png style=width:auto;height:auto alt=Logo><br><hr><span>Unofficial Grex User Guide</span><hr></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><hr><ul><li class=book-section-flat><a href=/grex-docs/docs/longread/>Notes of Grex Changes</a><ul><li class=book-section-flat><a href=/grex-docs/docs/longread/training/>Training Materials and Presentations</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/grex-docs/docs/computecanada/>Accessing Compute Canada resources</a><ul></ul></li><li class=book-section-flat><a href=/grex-docs/docs/grex/>Grex HPC QuickStart</a><ul><li><a href=/grex-docs/docs/grex/access/>Access and Usage conditions</a></li><li><a href=/grex-docs/docs/grex/connecting/>Connecting / Transferring data</a></li><li><a href=/grex-docs/docs/grex/data/>Storage and Data</a></li><li><a href=/grex-docs/docs/grex/running/>Running Jobs</a><ul><li><a href=/grex-docs/docs/grex/running/batch/>Batch jobs</a></li><li><a href=/grex-docs/docs/grex/running/interactive/ class=active>Interactive work</a><ul></ul></li><li><a href=/grex-docs/docs/grex/running/contributed-systems/>Contributed systems</a></li></ul></li><li><a href=/grex-docs/docs/grex/ood/>Grex's OpenOnDemand Web Portal</a></li><li><a href=/grex-docs/docs/grex/software/>Software</a></li></ul></li><li><a href=/grex-docs/docs/faq/>Frequently Asked Questions</a></li><li><a href=/grex-docs/docs/localit/>Local IT Resources</a></li><li><a href=/grex-docs/docs/support-contacts/>Support and Training</a></li><li><a href=/grex-docs/docs/disclaimer/>Disclaimer</a></li></ul></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></aside><div class=book-page><article class=markdown><h1 id=interactive-work>Interactive work</h1><p>The login nodes of Grex should be used to compile codes and to run short interactive calculations, compilation of code, and/or test runs. It is very easy to cause resource congestion on a shared Linux server. Therefore, all production calculations should be sumbitted in the batch mode, using our resource management system, SLURM. It is possible to submit so called <strong>interactive jobs</strong>: a job that creates an interactive session but actually runs on dedicated CPUs (and GPUs if needed) on the compute nodes rather than on the login servers (or head nodes).</p><p>Such mode of running interactive computations ensures that login nodes are not congested. A drawback is that when a cluster is busy, getting an interactive job to start will take some queuing time, just like any other job. So in practice interactive jobs are to be short and small to be able to utilize backfill-able nodes. This section covers how to run such jobs with SLURM.</p><p>Note that manual SSH connections to the compute nodes without having active running jobs is forbidden on Grex.</p><h2 id=interactive-batch-jobs>Interactive batch jobs</h2><p>To request an interactive jobs, the <strong>salloc</strong> command should be used. These jobs are not limited to single node jobs; any nodes/tasks/gpus layout can be requested by salloc in the same way as for sbatch. However, to minimize queuing time, usually a minimal set of required resources should be used when submitting interactive jobs (less than 3 H of walltime, less than 4 GB memory per core, etc.). Because there is no batch file for interactive jobs, all the resource requests should be added as command line options of the <strong>salloc</strong> command. The same logic of <strong>--nodes=</strong>, <strong>--ntasks-per-node=</strong> , <strong>--mem=</strong> and <strong>--cpus-per-task=</strong> resources as per batch jobs applies here as well.</p><p>For a threaded SMP code asking for half a node for two hours:</p><blockquote class="book-hint slurm"><code>salloc --nodes=1 --ntasks-per-node=1 --cpus-per-task=6 --mem=12000M --time=0-2:00:00</code></blockquote><p>For an MPI jobs asking for 48 tasks, irrespectively of the nodes layout:</p><blockquote class="book-hint slurm"><code>salloc --ntasks=48 --mem-per-task=2000M --time=0-2:00:00</code></blockquote><p>Similar to <a href=/grex-docs/docs/grex/running/batch/>batch jobs</a>
, specifying a partition with <strong>--partition=</strong> is required. Otherwise, the default partition will be used (as for now, <strong>skylake</strong> is set as default partition for CPU jobs).</p><h2 id=interactive-gpu-jobs>Interactive GPU jobs</h2><p>The difference for GPU jobs is that they would have to be directed to a node with GPU hardware:</p><blockquote class="book-hint slurm"><ul><li><p>The GPU jobs should run on the nodes that have GPU hardware, which means you&rsquo;d want always to specify <strong>--partition=gpu</strong> or <strong>--partition=stamps-b</strong>.</p></li><li><p>SLURM on Grex uses the so called &ldquo;GTRES&rdquo; plugin for scheduling GPU jobs, which means that a request in the form of <strong>--gpus=N</strong> or <strong>--\gpus-per-node=N</strong> or <strong>--gpus-per-task=N</strong> is required. Note that both partitions have up to four GPU per node, so asking more than 4 GPUs per node, or per task, is nonsensical. For interactive jobs, it makes more sense to use single GPU in most of the cases.</p></li></ul></blockquote><p>For an interactive session using two hours of one 16 GB V100 GPU, 4 CPUs and 4000MB per cpu:</p><blockquote class="book-hint slurm"><code>salloc --gpus=1 --cpus-per-task=4 --mem-per-cpu=4000M --time=0-2:00:00 --partition=stamps-b</code></blockquote><p>Similarly, for a 32 GB memory V100 GPU:</p><blockquote class="book-hint slurm"><code>salloc --gpus=1 --cpus-per-task=4 --mem-per-cpu=4000M --time=0-2:00:00 --partition=gpu</code></blockquote><h2 id=graphical-jobs>Graphical jobs</h2><p>What to do if your interactive job involves a GUI based program? You can SSH to a login node with X11 forwarding enabled, or using X2Go remote desktop, and run it there. It is also possible to forward the X11 connection to compute nodes where your interactive jobs run with <strong>--x11</strong> flag to <strong>salloc</strong>:</p><blockquote class="book-hint slurm"><code>salloc --ntasks=1 --x11 --mem=4000M</code></blockquote><p>To make it work you&rsquo;d want the SSH session login node is also supporting graphics: either through -Y flag of ssh (or X11 enabled in PuTTY) or by using X2Go.</p><p>You may also try to use <a href=/grex-docs/docs/grex/ood/>OpenOnDemand</a>
portal on Grex.</p></article><div class="book-footer justify-between"><div><a class="flex align-center" href=https://github.com/um-grex/grex-docs/commit/4a07d74120d95d4386c1c274f941df41cb1cc57e title="Last modified by Shamov | Feb 16, 2022" target=_blank><img src=/grex-docs/svg/calendar.svg class=book-icon alt=Calendar>
<span>Feb 16, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/um-grex/grex-docs/blob/master/content/docs/grex/running/interactive/_index.md target=_blank><img src=/grex-docs/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><br><hr></div><aside class="book-toc levels-4 fixed"><nav id=TableOfContents><ul><li><a href=#interactive-work>Interactive work</a><ul><li><a href=#interactive-batch-jobs>Interactive batch jobs</a></li><li><a href=#interactive-gpu-jobs>Interactive GPU jobs</a></li><li><a href=#graphical-jobs>Graphical jobs</a></li></ul></li></ul></nav></aside></main></body></html>